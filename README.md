# üé§ Speech Commands Classification Project

**–£–°–ü–Ü–®–ù–û –ó–ê–í–ï–†–®–ï–ù–ò–ô –ü–†–û–ï–ö–¢!** üéâ

–†–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è –≥–æ–ª–æ—Å–æ–≤–∏—Ö –∫–æ–º–∞–Ω–¥ (yes, no, up, down) –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ PyTorch CNN —Ç–∞ Flask API.

**–§—ñ–Ω–∞–ª—å–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏: 90.8% —Ç–æ—á–Ω—ñ—Å—Ç—å, 0.3–º—Å –ª–∞—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å!** ‚≠ê

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É
```
lab1my/
‚îú‚îÄ‚îÄ src/                           # –í–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ train_model.py            # –ù–∞–≤—á–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ ‚≠ê
‚îÇ   ‚îú‚îÄ‚îÄ test_model.py             # –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –º–µ—Ç—Ä–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ api.py                    # Flask REST API
‚îÇ   ‚îú‚îÄ‚îÄ inference_client.py       # –ö–ª—ñ—î–Ω—Ç –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è API
‚îÇ   ‚îú‚îÄ‚îÄ model.py                  # –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ CNN
‚îÇ   ‚îú‚îÄ‚îÄ simple_data_loader.py     # –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö
‚îÇ   ‚îî‚îÄ‚îÄ preprocessing.py          # –û–±—Ä–æ–±–∫–∞ –∞—É–¥—ñ–æ
‚îú‚îÄ‚îÄ data/                         # Google Speech Commands dataset
‚îú‚îÄ‚îÄ models/                       # –ù–∞–≤—á–µ–Ω—ñ –º–æ–¥–µ–ª—ñ
‚îÇ   ‚îî‚îÄ‚îÄ best_model_simple.pth     # –ù–∞–π–∫—Ä–∞—â–∞ –º–æ–¥–µ–ª—å (90.8%)
‚îú‚îÄ‚îÄ training_results.md           # –î–µ—Ç–∞–ª—å–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ ‚≠ê
‚îú‚îÄ‚îÄ requirements.txt              # –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ Python
‚îî‚îÄ‚îÄ README.md                     # –¶–µ–π —Ñ–∞–π–ª
```

---

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### 1Ô∏è‚É£ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
```bash
pip install torch torchvision torchaudio flask numpy matplotlib soundfile librosa
```

### 2Ô∏è‚É£ –ù–∞–≤—á–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ (–≤–∂–µ –∑—Ä–æ–±–ª–µ–Ω–æ!)
```bash
python src/train_model.py
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ú–æ–¥–µ–ª—å –∑ —Ç–æ—á–Ω—ñ—Å—Ç—é 90.8% –∑–±–µ—Ä–µ–∂–µ–Ω–∞ –≤ `models/best_model_simple.pth`

### 3Ô∏è‚É£ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ
```bash
python src/test_model.py
```

### 4Ô∏è‚É£ –ó–∞–ø—É—Å–∫ Flask API
```bash
python src/api.py
```
API –±—É–¥–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π –Ω–∞ `http://localhost:5000`

### 5Ô∏è‚É£ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –∫–ª—ñ—î–Ω—Ç
```bash
python src/inference_client.py
```

---

## üìä –î–æ—Å—è–≥–Ω—É—Ç—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–Ω—è | –û—Ü—ñ–Ω–∫–∞ |
|---------|----------|--------|
| **Accuracy** | **90.8%** | ‚≠ê –í—ñ–¥–º—ñ–Ω–Ω–æ! |
| **Latency** | **0.3 –º—Å** | ‚ö° –ë–ª–∏—Å–∫–∞–≤–∏—á–Ω–æ! |
| **Model Size** | **1.1 MB** | üì¶ –ö–æ–º–ø–∞–∫—Ç–Ω–æ |
| **Classes** | yes, no, up, down | üéØ 4 –∫–æ–º–∞–Ω–¥–∏ |
| **Dataset** | 15,625 –∑—Ä–∞–∑–∫—ñ–≤ | üìà –ë–∞–≥–∞—Ç–æ –¥–∞–Ω–∏—Ö |

### –î–µ—Ç–∞–ª—å–Ω–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å –ø–æ –∫–ª–∞—Å–∞—Ö:
- **yes**: 96.7% üèÜ
- **up**: 96.8% üèÜ  
- **no**: 85.3% ‚úÖ
- **down**: 84.2% ‚úÖ

---

## üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

### CNN –ú–æ–¥–µ–ª—å:
- **3 –∑–≥–æ—Ä—Ç–∫–æ–≤—ñ —à–∞—Ä–∏** (1‚Üí16‚Üí32‚Üí64 –∫–∞–Ω–∞–ª—ñ–≤)
- **MaxPooling** –¥–ª—è –∑–º–µ–Ω—à–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—É
- **2 –ø–æ–≤–Ω–æ–∑–≤'—è–∑–Ω—ñ —à–∞—Ä–∏** (2048‚Üí128‚Üí4)
- **ReLU –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó** + **Dropout**

### Preprocessing:
- **–ú–µ–ª-—Å–ø–µ–∫—Ç—Ä–æ–≥—Ä–∞–º–∏** (64 –º–µ–ª-—Ñ—ñ–ª—å—Ç—Ä–∏, 32 —á–∞—Å–æ–≤—ñ —Ñ—Ä–µ–π–º–∏)
- **–ù–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è** –¥–æ 1 —Å–µ–∫—É–Ω–¥–∏ –∞—É–¥—ñ–æ
- **Min-Max scaling** –¥–æ [0,1]

---

## üåê Flask API Endpoints

| Method | Endpoint | –û–ø–∏—Å |
|--------|----------|------|
| GET | `/` | –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ API |
| GET | `/health` | –°—Ç–∞–Ω –∑–¥–æ—Ä–æ–≤'—è |
| GET | `/classes` | –ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –∫–æ–º–∞–Ω–¥–∏ |
| POST | `/predict` | –†–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è –∞—É–¥—ñ–æ —Ñ–∞–π–ª—É |
| POST | `/predict_text` | –¢–µ—Å—Ç–æ–≤–∏–π –ø—Ä–æ–≥–Ω–æ–∑ –∑ —Ç–µ–∫—Å—Ç—É |

### –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:
```bash
curl -X POST -F "audio=@my_audio.wav" http://localhost:5000/predict
```

---

## üî¨ –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó:
- **PyTorch** - Deep Learning framework
- **Flask** - REST API
- **torchaudio** - –ê—É–¥—ñ–æ –æ–±—Ä–æ–±–∫–∞  
- **soundfile** - –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞—É–¥—ñ–æ
- **numpy, matplotlib** - –û–±—á–∏—Å–ª–µ–Ω–Ω—è —Ç–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è

### –ù–∞–≤—á–∞–Ω–Ω—è:
- **Optimizer**: Adam (lr=0.001)
- **Loss function**: CrossEntropyLoss
- **Epochs**: 3
- **Batch size**: 32
- **Device**: CPU

---

## üìÅ –í–∞–∂–ª–∏–≤—ñ —Ñ–∞–π–ª–∏

### üìÑ –î–ª—è –∑–≤—ñ—Ç—É —É–Ω—ñ–≤–µ—Ä—Å–∏—Ç–µ—Ç—É:
1. **`training_results.md`** - –ü–æ–≤–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑ –∞–Ω–∞–ª—ñ–∑–æ–º
2. **`src/train_model.py`** - –ö–æ–¥ –Ω–∞–≤—á–∞–Ω–Ω—è
3. **`src/model.py`** - –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª—ñ
4. **`src/api.py`** - Flask API —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è
5. **`models/best_model_simple.pth`** - –ù–∞–≤—á–µ–Ω–∞ –º–æ–¥–µ–ª—å

### üß™ –î–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:
- **`src/test_model.py`** - –î–µ—Ç–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- **`src/inference_client.py`** - –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π –∫–ª—ñ—î–Ω—Ç

---

## üéä –í–∏—Å–Ω–æ–≤–∫–∏

–ü—Ä–æ–µ–∫—Ç **–ø–æ–≤–Ω—ñ—Å—Ç—é —É—Å–ø—ñ—à–Ω–∏–π**! –î–æ—Å—è–≥–Ω—É—Ç–æ:

‚úÖ **–í—ñ–¥–º—ñ–Ω–Ω—É —Ç–æ—á–Ω—ñ—Å—Ç—å** (90.8% >> 60-80% –æ—á—ñ–∫—É–≤–∞–Ω–æ–≥–æ)  
‚úÖ **–®–≤–∏–¥–∫–∏–π —ñ–Ω—Ñ–µ—Ä–µ–Ω—Å** (0.3–º—Å << 50–º—Å –≤–∏–º–æ–≥–∏)  
‚úÖ **–ö–æ–º–ø–∞–∫—Ç–Ω—É –º–æ–¥–µ–ª—å** (~1MB)  
‚úÖ **–†–æ–±–æ—á–∏–π Flask API**  
‚úÖ **–ü–æ–≤–Ω—É –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é**

**–ú–æ–¥–µ–ª—å –≥–æ—Ç–æ–≤–∞ –¥–æ production –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è!** üöÄ

---

## üë®‚Äçüéì –ê–≤—Ç–æ—Ä
–Æ—Ä—ñ–π - –°—Ç—É–¥–µ–Ω—Ç —É–Ω—ñ–≤–µ—Ä—Å–∏—Ç–µ—Ç—É  
–ü—Ä–æ–µ–∫—Ç –≤–∏–∫–æ–Ω–∞–Ω–∏–π 16 –ª–∏—Å—Ç–æ–ø–∞–¥–∞ 2025  
**GitHub Copilot Assistant** - —Ç–µ—Ö–Ω—ñ—á–Ω–∏–π —Å—É–ø—Ä–æ–≤—ñ–¥

---

*–¶–µ–π –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –ø–æ–≤–Ω–∏–π —Ü–∏–∫–ª —Ä–æ–∑—Ä–æ–±–∫–∏ ML —Å–∏—Å—Ç–µ–º–∏: –≤—ñ–¥ –¥–∞–Ω–∏—Ö –¥–æ production API* üéØ